# 每日安全资讯 (2025-06-07)

今日未发现新的安全文章，以下是 AI 分析结果：

# AI 安全分析日报 (2025-06-07)

本文档包含 AI 对安全相关内容的自动化分析结果。[概览](https://blog.897010.xyz/c/today)


### CVE-2024-3094 - XZ Utils后门，代码执行

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2024-3094 |
| 风险等级 | `CRITICAL` |
| 利用状态 | `漏洞利用可用` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 16:26:09 |

#### 📦 相关仓库

- [cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

#### 💡 分析概述

该仓库提供了针对CVE-2024-3094漏洞的分析和利用代码。 主要功能是构建和修改受影响的 liblzma 库，以及提供一个模拟的 SSH 客户端来触发漏洞。

代码分析:

1.  `client.py`: 这是一个 Python 脚本，它模拟一个 SSH 客户端，尝试连接到 SSH 服务器，并在认证过程中利用修改过的 RSA 密钥。该脚本构建了一个恶意的 RSA 密钥，其中包含了嵌入的 shell 命令。主要逻辑包括：
    *   `XzSigner` 类： 负责构建payload，包含生成用于加密的header和Chacha20加密。
    *   `ModifiedRSAClient` 类： 模拟 SSH 客户端，使用修改过的 RSA 公钥进行身份验证。关键在于 `query()` 方法，该方法构造包含恶意负载的 RSA 公钥，并尝试连接到 SSH 服务器。
    *   主程序：  通过提供私钥等参数，构造 `XzSigner` 和 `ModifiedRSAClient` 对象，并通过 `query` 方法发送构造的payload。

2.  `client2.py`: 这是一个新的脚本，模拟了针对后门的SSH Agent攻击，包括构造payload，以及构造用于绕过认证的 RSA Key。

3.  `patch_libzma.py`:  Python 脚本，用于修改 liblzma 库，注入后门代码。它通过查找特定的函数签名，并将恶意代码插入到库中，将ed448的公钥植入到 liblzma。该脚本能够patch liblzma，注入恶意代码。它依赖于 `liblzma.so.5.6.0.patch`，这个patch文件应该包含了需要修改的 liblzma 库的二进制补丁。并使用 `patch_libzma.py` 注入恶意代码。

4.  `detector.sh`: Shell脚本，用于检测 liblzma 库是否包含后门。

5.  `rule.yar`:  Yara 规则，用于检测 liblzma 库中的恶意代码。

漏洞利用方式：

1.  攻击者通过构造恶意的 RSA 密钥，将恶意命令嵌入到 SSH 认证过程中，触发代码执行。具体步骤如下：
    *   攻击者使用精心构造的 RSA 密钥和签名，绕过 SSH 服务器的认证。
    *   在身份验证期间，服务器会处理包含恶意负载的 RSA 密钥。
    *   服务器执行 RSA 密钥中嵌入的恶意命令，例如 `id > /tmp/.xz`。

2.  通过修改 liblzma 库，植入后门，使得系统在加载该库时执行恶意代码。

更新内容分析：

1.  `.gitignore`:  添加了更多敏感文件，例如`privkey.pem`，说明项目正在完善。

2.  `client.py`:  修改了测试代码，增加了日志，以及build_payload的修改，`build_payload`中修改了命令，由 `id > /tmp/.xz` 修改为 `sleep 60`，说明脚本正在开发调试阶段，增加了chacha20加密相关的代码，以及build_payload的修改。

3.  `client2.py`: 新增了 `client2.py`，模拟了一个ssh agent，并支持绕过密码验证，演示了该漏洞的攻击方式。

4.  `patch_libzma.py`: 增加一个对 `argv` 的检查，使得patch更加完善。

5.  `detector.sh`: 修改了日志输出，使得输出更加明确。

6.  `rule.yar`: 修复了yara规则，更加准确的检测出恶意代码。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | 利用修改的 RSA 密钥绕过 SSH 认证，执行任意命令。 |
| 2 | 通过修改 liblzma 库植入后门，实现持久化攻击。 |
| 3 | 提供了POC，包括构造恶意密钥，以及触发后门执行。 |
| 4 | 攻击针对 OpenSSH 服务，影响广泛。 |
| 5 | 代码包含了对后门检测和利用的完整流程。 |

#### 🛠️ 技术细节

> 通过修改 RSA 密钥的认证过程，将恶意命令注入到 SSH 身份验证流程中。

> 使用 ChaCha20 对 payload 进行加密，增加攻击的隐蔽性。

> 修改 liblzma 库，植入后门，实现持久化攻击。

> POC 演示了构造恶意密钥，并与 SSH 服务器交互的过程。

> 提供了检测后门的脚本和 Yara 规则。


#### 🎯 受影响组件

```
• liblzma 库
• OpenSSH 服务
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

该漏洞影响广泛使用的组件（liblzma, OpenSSH），提供了明确的利用方法（构造恶意密钥、修改liblzma），且包含POC和攻击代码。该漏洞危害大，可导致远程代码执行。
</details>

---

### CVE-2025-44228 - Office文档RCE漏洞，影响Office 365

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2025-44228 |
| 风险等级 | `HIGH` |
| 利用状态 | `理论可行` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 16:20:11 |

#### 📦 相关仓库

- [Office-Exploit-Cve2025-Xml-Doc-Docx-Rce-Builder-Fud](https://github.com/Caztemaz/Office-Exploit-Cve2025-Xml-Doc-Docx-Rce-Builder-Fud)

#### 💡 分析概述

该CVE描述了针对CVE-2025-44228的漏洞利用开发，目标是Office文档的漏洞，特别是DOC文件。该仓库提供了一个针对Office文档的漏洞利用构建器，旨在生成恶意载荷并利用CVE漏洞，影响Office 365等平台。该仓库提供了相关工具，用于生成或构建针对office的恶意文档，实现RCE。最新提交主要更新了LOG文件中的日期，没有实质性的代码改动。整体来看，该仓库关注的是构建针对Office文档的漏洞利用，具有一定的风险，但具体漏洞利用方式和细节有待进一步分析。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | 针对Office文档的RCE漏洞。 |
| 2 | 利用恶意文档进行攻击。 |
| 3 | 可能影响Office 365等平台。 |

#### 🛠️ 技术细节

> 通过恶意构造的DOC文件，利用Office软件的漏洞。

> 利用漏洞构建器生成包含恶意载荷的文档。

> 漏洞利用的原理和具体细节需要进一步分析，如需进一步挖掘漏洞，可能需要查看GitHub仓库的源代码。


#### 🎯 受影响组件

```
• Office 365
• DOC文件
• Office软件
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

该漏洞涉及RCE，针对广泛使用的Office软件和Office 365，存在明确的利用目标（Office文档）和潜在的恶意载荷，具备较高价值。
</details>

---

### CVE-2025-31258 - macOS沙箱逃逸(部分)PoC

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2025-31258 |
| 风险等级 | `HIGH` |
| 利用状态 | `POC可用` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 16:11:53 |

#### 📦 相关仓库

- [CVE-2025-31258-PoC](https://github.com/BODE987/CVE-2025-31258-PoC)

#### 💡 分析概述

该仓库是一个针对macOS沙箱逃逸的PoC项目。主要功能是利用RemoteViewServices框架实现部分沙箱逃逸。 

初始提交创建了Xcode项目，包含AppDelegate, ViewController等基本文件，以及必要的配置文件和资源。在后续的更新中，README.md文件被大幅修改，添加了项目的概述、安装、使用方法和技术细节。 其中，README.md 详细介绍了 CVE-2025-31258 漏洞，包括受影响的 macOS 版本 (10.15-11.5)，可能的攻击向量和缓解策略。ViewController.m 中包含了利用 `PBOXDuplicateRequest` 函数的POC代码, 通过调用私有API尝试拷贝文件，展示了部分沙箱逃逸的能力。通过`writeFileAtPath` 函数在沙箱外写入文件，验证了沙箱逃逸的效果。

漏洞利用方式：
1.  通过 RemoteViewServices 框架中的 `PBOXDuplicateRequest`  函数尝试复制文件。
2.  通过 `writeFileAtPath` 函数在沙箱外写文件。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | 利用RemoteViewServices框架进行沙箱逃逸 |
| 2 | POC代码展示了部分沙箱逃逸的能力 |
| 3 | 通过写入文件验证了逃逸效果 |
| 4 | 涉及macOS系统关键框架，可能影响广泛 |

#### 🛠️ 技术细节

> 漏洞利用了RemoteViewServices框架的缺陷。

> POC使用PBOXDuplicateRequest函数尝试复制文件，绕过沙箱限制。

> 通过writeFileAtPath函数在沙箱外写入文件，验证了逃逸的成功。


#### 🎯 受影响组件

```
• macOS
• RemoteViewServices
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

该PoC 演示了macOS沙箱逃逸，虽然是部分逃逸，但展示了潜在的风险，并且POC代码可以直接运行，验证了漏洞的存在和可利用性，且利用了关键的macOS框架，具有较高的研究价值。
</details>

---

### CVE-2025-32433 - Erlang SSH 服务器远程代码执行

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2025-32433 |
| 风险等级 | `CRITICAL` |
| 利用状态 | `漏洞利用可用` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 15:45:11 |

#### 📦 相关仓库

- [CVE-2025-32433](https://github.com/rizky412/CVE-2025-32433)

#### 💡 分析概述

该仓库提供了一个针对 CVE-2025-32433 漏洞的 PoC。 仓库中包含一个 Dockerfile 用于构建易受攻击的 Erlang SSH 服务器，以及一个 Python 脚本 (CVE-2025-32433.py) 用于利用此漏洞。  

代码更新分析：
1.  添加了 README.md 文件，对 CVE-2025-32433 进行了简单的介绍，并提到了漏洞的官方公告。
2.  添加了 Dockerfile，用于构建一个包含 Erlang/OTP 和 ssh_server.erl 的 Docker 镜像。 镜像构建了易受攻击的 Erlang SSH 服务器。 包含生成 RSA 密钥的命令。
3.  添加了 ssh_server.erl 文件，该文件实现了一个简单的 Erlang SSH 服务器，该服务器配置了密码身份验证，其中 pwdfun 接受任何用户名和密码，并返回 true，这表明它允许通过身份验证。
4.  添加了 CVE-2025-32433.py 文件，这是一个 Python 脚本，用于利用 SSH 服务器中的漏洞。 该脚本通过发送一个精心构造的 SSH 消息序列来实现远程代码执行。
5.  修改了 ssh_server.erl 文件中的 pwdfun，使其返回 false，表明身份验证失败。这是为了修复登录失败，与PoC无关， 仅用于测试目的。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | 漏洞允许未经授权的代码执行 |
| 2 | PoC 利用预身份验证漏洞 |
| 3 | 影响使用易受攻击版本的 Erlang SSH 服务器 |
| 4 | PoC 代码已提供，可用于验证漏洞 |

#### 🛠️ 技术细节

> 漏洞利用通过发送一系列精心构造的 SSH 消息来完成，绕过了身份验证。

> PoC 脚本（CVE-2025-32433.py）构造并发送 KEXINIT、CHANNEL_OPEN 和 CHANNEL_REQUEST 消息。

> CHANNEL_REQUEST 消息用于在预身份验证阶段执行任意命令。

> Dockerfile 用于构建易受攻击的环境进行测试。


#### 🎯 受影响组件

```
• Erlang SSH 服务器
• Erlang/OTP
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

该漏洞允许未经授权的远程代码执行，且提供了可用的PoC代码，可以验证漏洞，对系统安全造成严重威胁。
</details>

---

### CVE-2024-25600 - WordPress Bricks Builder RCE

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2024-25600 |
| 风险等级 | `CRITICAL` |
| 利用状态 | `漏洞利用可用` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 15:29:36 |

#### 📦 相关仓库

- [CVE-2024-25600](https://github.com/cboss43/CVE-2024-25600)

#### 💡 分析概述

该仓库提供了针对WordPress Bricks Builder插件(<=1.9.6)的未授权远程代码执行(RCE)漏洞的利用代码。 仓库结构简单，主要包含一个Python脚本(exploit.py)和一个README.md文件。 exploit.py通过向目标WordPress站点发送构造的POST请求来触发漏洞，该请求利用了插件中`render_element`端点处理用户输入时的不安全行为，从而执行任意代码。该脚本首先尝试获取nonce，然后发送恶意payload执行命令并获取结果，最终提供一个交互式shell。最近的更新主要集中在改进README.md文件，使其更具可读性和指导性，以及修复代码中的一些bug，例如修正了python3的执行声明。此外，新增了下载exploit的入口，提升了用户体验。漏洞利用方式是构造特定的POST请求，通过修改queryEditor参数来注入恶意PHP代码。由于是未授权漏洞，攻击者无需认证即可利用。漏洞可能导致站点完全控制，数据泄露或恶意软件分发。该漏洞影响广泛使用的WordPress插件，且存在可用的利用代码，因此具有高价值。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | WordPress Bricks Builder插件存在未授权RCE漏洞(CVE-2024-25600) |
| 2 | 攻击者可以远程执行任意PHP代码，无需身份验证 |
| 3 | 影响Bricks Builder插件1.9.6及以下版本 |
| 4 | 提供了可用的Python脚本进行漏洞利用 |
| 5 | 漏洞利用涉及构造特定的POST请求，注入恶意PHP代码 |

#### 🛠️ 技术细节

> 漏洞位于Bricks Builder插件的`/wp-json/bricks/v1/render_element`端点。

> 利用方法是构造POST请求，修改queryEditor参数，注入恶意PHP代码。

> 修复方案：更新Bricks Builder插件至1.9.6以上版本；或采用WAF等方式过滤请求，限制对`/wp-json/bricks/v1/render_element`端点的访问。


#### 🎯 受影响组件

```
• WordPress
• Bricks Builder <= 1.9.6
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

漏洞影响广泛使用的WordPress插件，存在未授权RCE，且有完整的利用代码，可以直接用于攻击。
</details>

---

### CVE-2025-0411 - 7-Zip MotW Bypass 漏洞POC

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2025-0411 |
| 风险等级 | `HIGH` |
| 利用状态 | `POC可用` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 18:03:22 |

#### 📦 相关仓库

- [7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

#### 💡 分析概述

该仓库提供CVE-2025-0411的POC，该漏洞是7-Zip的Mark-of-the-Web(MotW)绕过漏洞。仓库包含了POC场景，展示了如何绕过MotW保护机制。主要通过双重压缩可执行文件，绕过安全警告，实现代码执行。最近的提交主要更新了README.md文件，修改了链接，完善了漏洞描述和POC使用说明。漏洞利用方式为：构造恶意的7z压缩文件，其中包含带有MotW信息的文件。7-Zip在处理该压缩文件时，未正确传递MotW信息给解压出的文件，导致绕过MotW安全机制。攻击者诱使用户解压并运行该文件，从而执行任意代码。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | 7-Zip MotW绕过 |
| 2 | POC代码可用 |
| 3 | 影响7-Zip软件 |
| 4 | 用户交互，恶意文件执行 |

#### 🛠️ 技术细节

> 漏洞原理：7-Zip在处理压缩文件时，没有正确传递MotW信息给解压出的文件。

> 利用方法：构造恶意7z文件，诱导用户解压并执行。

> 修复方案：升级到7-Zip 24.09或更高版本。


#### 🎯 受影响组件

```
• 7-Zip
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

该漏洞影响广泛使用的7-Zip软件，且POC代码可用，存在被恶意利用的风险，可以实现代码执行。
</details>

---

### CVE-2024-20674 - Kerberos U2U 身份验证绕过

#### 📌 漏洞信息

| 属性 | 详情 |
|------|------|
| CVE编号 | CVE-2024-20674 |
| 风险等级 | `CRITICAL` |
| 利用状态 | `漏洞利用可用` |
| 发布时间 | 2025-06-06 00:00:00 |
| 最后更新 | 2025-06-06 17:32:11 |

#### 📦 相关仓库

- [CVE-2024-20674](https://github.com/gpotter2/CVE-2024-20674)

#### 💡 分析概述

该仓库提供了CVE-2024-20674 Kerberos U2U身份验证绕过的漏洞利用代码。仓库包含一个`exploit.py`脚本，该脚本实现了SMB服务器，该服务器利用Kerberos客户端在处理Kerberos U2U TGT-REP时存在的逻辑错误来绕过身份验证。该漏洞允许攻击者通过伪造DC来提供任意GPO，进而控制机器。仓库还包含一个`demo`目录，其中包含用于演示利用的GPO文件和`demo_video.mp4`视频。初始提交引入了漏洞利用代码和demo资源，更新提交完善了README文件，增加了对漏洞的说明和利用场景。漏洞利用依赖于中间人攻击，劫持 Kerberos 流量，并伪造 Kerberos 响应，从而绕过客户端的身份验证。

#### 🔍 关键发现

| 序号 | 发现内容 |
|------|----------|
| 1 | Kerberos U2U 身份验证绕过 |
| 2 | 通过SMB服务器实现漏洞利用 |
| 3 | 利用GPO控制目标机器 |
| 4 | 需要中间人攻击劫持Kerberos流量 |

#### 🛠️ 技术细节

> 漏洞利用了Kerberos U2U TGT-REP在客户端处理中的逻辑错误，构造特定的Kerberos错误响应，欺骗客户端

> exploit.py脚本启动一个SMB服务器，该服务器通过自定义的KerberosSSP来处理身份验证，并拦截TGS-REQ请求，迫使其使用U2U认证

> 通过中间人攻击，拦截并修改Kerberos流量，将客户端引导到攻击者控制的SMB服务器，然后提供恶意GPO

> 修复方案：更新Kerberos客户端处理逻辑，正确验证U2U TGT-REP


#### 🎯 受影响组件

```
• Kerberos客户端
• SMB服务器
```

#### ⚡ 价值评估

<details>
<summary>展开查看详细评估</summary>

该漏洞允许攻击者绕过身份验证，控制目标机器，属于远程代码执行范畴，危害严重，且提供了可用的POC。
</details>

---
